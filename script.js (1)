async function generatePDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    doc.setFontSize(16);
    doc.text("PP2 Off Loading Sheet", 10, 10);

    let y = 20;
    doc.setFontSize(12);
    doc.text("Part", 10, y);
    doc.text("Color", 60, y);
    doc.text("Total", 110, y);
    doc.text("Rework (Defect)", 140, y);
    doc.text("Polished", 180, y);
    doc.text("Scrap (Defect)", 220, y);
    doc.text("Remarks", 260, y);
    doc.text("Date", 280, y); // Include the Date column
    y += 10;

    // Retrieve all saved data from local storage
    const storedData = localStorage.getItem('pp2LoadingSheetData');
    if (storedData) {
        const tableData = JSON.parse(storedData);
        tableData.forEach(rowData => {
            doc.text(rowData.part, 10, y);
            doc.text(rowData.color, 60, y);
            doc.text(rowData.total, 110, y);
            doc.text(`${rowData.rework.value} (${rowData.rework.defect})`, 140, y);
            doc.text(rowData.polished, 180, y);
            doc.text(`${rowData.scrap.value} (${rowData.scrap.defect})`, 220, y);
            doc.text(rowData.remarks, 260, y);
            doc.text(rowData.date, 280, y); // Add the date to the PDF
            y += 10;
        });
    } else {
        doc.text("No data available to generate PDF.", 10, y);
    }

    doc.save("PP2_Off_Loading_Sheet.pdf");
}
